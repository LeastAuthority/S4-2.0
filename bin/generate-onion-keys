#!/usr/bin/env python

from sys import argv

from stem.control import Controller

def main(base_path="signup-website"):
    c = Controller.from_port()
    c.authenticate()
    response = c.create_ephemeral_hidden_service(
        80,
        key_type="NEW",
        key_content="ED25519-V3",
    )
    with open(base_path + ".hostname", "w") as hostname:
        hostname.write(
            response.service_id + ".onion\n"
        )
    with open(base_path + ".secret", "w") as secret:
        secret.write(
            "== ed25519v1-secret: type0 ==\x00\x00\x00" +
            response.private_key.decode("base64")
        )

main(*argv[1:])
