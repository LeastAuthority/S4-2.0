#!/usr/bin/env python

from stem.control import Controller
from binascii import a2b_base64

def main():
    c = Controller.from_port()
    c.authenticate()
    response = c.create_ephemeral_hidden_service(
        80,
        key_type="NEW",
        key_content="ED25519-V3",
    )
    with open("signup-website.hostname", "w") as hostname:
        hostname.write(
            response.service_id + ".onion\n"
        )
    with open("signup-website.secret", "wb") as secret:
        secret.write(
            b"== ed25519v1-secret: type0 ==\x00\x00\x00" +
            a2b_base64(response.private_key)
        )

main()
